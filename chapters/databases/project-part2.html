<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>24.11. Project: Movie SQLs (Part 2) &#8212; LaunchCode&#39;s LCHS  documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fa/css/all.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/launchcode.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/site.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="25. Build a Minesweeper Game" href="../databases-part2/index.html" />
    <link rel="prev" title="24.10. Project: Movie SQLs" href="project.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body class="body-bc">

<div id="navbar" class="navbar navbar-default navbar-fixed-top">
   <div class="container">
     <div class="navbar-header">
       <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
       <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
       </button>
       <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/lc-ed-logo.png" alt="LaunchCode logo"></span>
       </a>
       <span class="navbar-text navbar-version pull-left"><b></b></span>
     </div>

       <div class="collapse navbar-collapse nav-collapse">
         <ul class="nav navbar-nav">
           
           
             
           
           
           
           
           
         </ul>

         
           
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
    <label for="q" class="searchLabel">Search</label>
    <input type="text" name="q" class="form-control" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
         
       </div>
   </div>
 </div>

<ol class="breadcrumb container">
    <li><a href="../../index.html">Contents</a></li>
    <li><a href="index.html"><span class="section-number">24. </span>Databases</a></li>
    <li class="active"><span class="section-number">24.11. </span>Project: Movie SQLs (Part 2)</li>
</ol>



<div class="container">
  <div class="row">
    <div class="col-md-10 col-md-offset-1 content " role="main">

    
  <div class="section" id="project-movie-sqls-part-2">
<span id="movie-sql-part-2"></span><h1><span class="section-number">24.11. </span>Project: Movie SQLs (Part 2)<a class="headerlink" href="#project-movie-sqls-part-2" title="Permalink to this headline">¶</a></h1>
<p>Now that each of your CRUD functions creates a <code class="docutils literal notranslate"><span class="pre">sql_query</span></code> string, the next
step is to perform those actions! On this page, you will add a new function to
your Python code. Its job is to execute any query string it receives.</p>
<div class="section" id="define-the-execute-query-function">
<h2><span class="section-number">24.11.1. </span>Define the <code class="docutils literal notranslate"><span class="pre">execute_query</span></code> Function<a class="headerlink" href="#define-the-execute-query-function" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">BEFORE the <code class="docutils literal notranslate"><span class="pre">index()</span></code> function, paste in this starter code for the
<code class="docutils literal notranslate"><span class="pre">execute_query()</span></code> function:</p>
<div class="highlight-Python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">execute_query</span><span class="p">(</span><span class="n">query_string</span><span class="p">):</span>
   <span class="n">db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;project.db&#39;</span><span class="p">)</span>
   <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
   <span class="k">if</span> <span class="s2">&quot;select&quot;</span> <span class="ow">in</span> <span class="n">query_string</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
      <span class="k">pass</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="k">pass</span>
   <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
   <span class="k">return</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
   <span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</pre></div>
</td></tr></table></div>
<ol class="loweralpha simple">
<li>Line 8 defines the function with a single parameter. <code class="docutils literal notranslate"><span class="pre">query_string</span></code>
receives the SQL queries created by the other functions.</li>
<li>Lines 9 and 10 open a connection to the database and initialize the
<code class="docutils literal notranslate"><span class="pre">db</span></code> and <code class="docutils literal notranslate"><span class="pre">cursor</span></code> objects.</li>
<li>Line 15 closes the connection to the database after each SQL query.</li>
<li>Lines 11 - 14 will contain the code to run the SQL queries.</li>
</ol>
</li>
<li><p class="first">Note the condition in line 11. If the SQL query calls for a SELECT
operation, the function will return a list of results from the database.
Update the code to assign those results to a variable, then return them.</p>
<div class="highlight-Python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">execute_query</span><span class="p">(</span><span class="n">query_string</span><span class="p">):</span>
   <span class="n">db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;project.db&#39;</span><span class="p">)</span>
   <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
   <span class="k">if</span> <span class="s2">&quot;select&quot;</span> <span class="ow">in</span> <span class="n">query_string</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
      <span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query_string</span><span class="p">))</span> <span class="c1"># Create a list of data from project.db.</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="k">pass</span>
   <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
   <span class="k">return</span> <span class="n">results</span>    <span class="c1"># Return the results of the SQL query.</span>
</pre></div>
</td></tr></table></div>
</li>
<li><p class="first">The INSERT, UPDATE, and DELETE queries all follow the same the pattern of
execution. Add the following code to the <code class="docutils literal notranslate"><span class="pre">else</span></code> clause:</p>
<div class="highlight-Python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">execute_query</span><span class="p">(</span><span class="n">query_string</span><span class="p">):</span>
   <span class="n">db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;project.db&#39;</span><span class="p">)</span>
   <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
   <span class="k">if</span> <span class="s1">&#39;select&#39;</span> <span class="ow">in</span> <span class="n">query_string</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
      <span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query_string</span><span class="p">))</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query_string</span><span class="p">)</span>  <span class="c1"># Execute the query.</span>
      <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>                   <span class="c1"># Commit the changes to the database.</span>
      <span class="n">results</span> <span class="o">=</span> <span class="s1">&#39;success&#39;</span>           <span class="c1"># Assign a value to &#39;results&#39;.</span>
   <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
   <span class="k">return</span> <span class="n">results</span>
</pre></div>
</td></tr></table></div>
</li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">execute_query()</span></code> code works, but it contains a rather large hole. You
will find this when you run the test queries in the next section.</p>
<div class="admonition-note admonition">
<p class="first admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>Note</p>
<p class="last">The code for displaying the query results is already part of <code class="docutils literal notranslate"><span class="pre">base.html</span></code>.
Feel free to explore the Jinja2 logic in the template to see how it uses
the data from <code class="docutils literal notranslate"><span class="pre">render_template()</span></code> and the session cookie.</p>
</div>
<div class="section" id="don-t-expect-perfect-syntax">
<h3><span class="section-number">24.11.1.1. </span>Don’t Expect Perfect Syntax<a class="headerlink" href="#don-t-expect-perfect-syntax" title="Permalink to this headline">¶</a></h3>
<p>Launch <code class="docutils literal notranslate"><span class="pre">main.py</span></code>, then run these two test cases:</p>
<ol class="arabic simple">
<li>From the home page, choose <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> and <code class="docutils literal notranslate"><span class="pre">movies</span></code>. Enter <code class="docutils literal notranslate"><span class="pre">*</span></code> in the
first box and leave the WHERE box empty. If your <code class="docutils literal notranslate"><span class="pre">execute_query()</span></code>
function works, you will see a table of data appear below the form.</li>
<li>Submit the form again, but this time use a column name that does NOT appear
in the <code class="docutils literal notranslate"><span class="pre">movies</span></code> table. How does your program respond?</li>
</ol>
<p>Yikes! Hopefully, you saw your program crash.</p>
<div class="figure align-default" id="id1">
<img alt="Showing an Operational Error message. The submitted column name isn't in the movies table." src="../../_images/sql-error.png" />
<p class="caption"><span class="caption-text">Entering an incorrect column name throws an error and crashes the application.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>Any error in the SQL query causes the application to crash. This occurs no
matter how tiny the mistake. Even forgetting to put quotes around a string
value is enough to throw an error.</p>
<p>You should expect users to make mistakes in any of the forms, so your program
must be able to survive these errors. You should also provide users feedback
about what went wrong.</p>
</div>
</div>
<div class="section" id="catch-sql-syntax-errors">
<h2><span class="section-number">24.11.2. </span>Catch SQL Syntax Errors<a class="headerlink" href="#catch-sql-syntax-errors" title="Permalink to this headline">¶</a></h2>
<p>As shown above, if a user submits invalid information, the application crashes.
While it is possible to check a SQL string before calling <code class="docutils literal notranslate"><span class="pre">.execute()</span></code>, this
requires a rather large amount of code. Fortunately, there is a nifty shortcut
we can use instead.</p>
<ol class="arabic">
<li><p class="first">Update the <code class="docutils literal notranslate"><span class="pre">execute_query()</span></code> function as follows:</p>
<div class="highlight-Python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s2">&quot;select&quot;</span> <span class="ow">in</span> <span class="n">query_string</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
   <span class="k">try</span><span class="p">:</span>
      <span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query_string</span><span class="p">))</span>
   <span class="k">except</span><span class="p">:</span>
      <span class="n">results</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span>
</pre></div>
</td></tr></table></div>
</li>
<li id="index-0"><p class="first">This demonstrates how to use a <strong>try/except</strong> block. Python <em>tries</em> to run
the code on line 13. If <code class="docutils literal notranslate"><span class="pre">query_string</span></code> contains no mistakes,
<code class="docutils literal notranslate"><span class="pre">.execute()</span></code> runs fine, and <code class="docutils literal notranslate"><span class="pre">results</span></code> is assigned data from the table.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">query_string</span></code> is incorrect, <code class="docutils literal notranslate"><span class="pre">.execute()</span></code> throws an error. However,
instead of crashing, Python moves to the <code class="docutils literal notranslate"><span class="pre">except</span></code> clause and runs the code
there! The <code class="docutils literal notranslate"><span class="pre">try/except</span></code> block <em>prevents the program from crashing</em> by
providing a safe, alternative set of code. In this case, it assigns the
<code class="docutils literal notranslate"><span class="pre">'error'</span></code> string to <code class="docutils literal notranslate"><span class="pre">results</span></code>.</p>
</li>
<li><p class="first">Cool! <code class="docutils literal notranslate"><span class="pre">try/except</span></code> saves you some time, since you don’t need to do a
detailed check of the SQL string.</p>
</li>
<li><p class="first">Add a <code class="docutils literal notranslate"><span class="pre">try/except</span></code> block to the <code class="docutils literal notranslate"><span class="pre">else</span></code> clause as well:</p>
<div class="highlight-Python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">else</span><span class="p">:</span>
   <span class="k">try</span><span class="p">:</span>
      <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query_string</span><span class="p">)</span>
      <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
      <span class="n">results</span> <span class="o">=</span> <span class="s2">&quot;success&quot;</span>
   <span class="k">except</span><span class="p">:</span>
         <span class="n">results</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span>
<span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">return</span> <span class="n">results</span>
</pre></div>
</td></tr></table></div>
</li>
</ol>
<div class="section" id="run-test-cases">
<h3><span class="section-number">24.11.2.1. </span>Run Test Cases<a class="headerlink" href="#run-test-cases" title="Permalink to this headline">¶</a></h3>
<p>Test out the new <code class="docutils literal notranslate"><span class="pre">execute_query()</span></code> function. Be sure to try valid and invalid
entries in each form.</p>
<ol class="arabic">
<li><p class="first">From the home page, select <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> and <code class="docutils literal notranslate"><span class="pre">movies</span></code>. Enter <code class="docutils literal notranslate"><span class="pre">title</span></code> in the
columns box. In the values box, enter the title of your favorite movie.
IMPORTANT: Put quotes around the movie title.</p>
<p>If your <code class="docutils literal notranslate"><span class="pre">execute_query()</span></code> function works, <code class="docutils literal notranslate"><span class="pre">Query</span> <span class="pre">successfully</span> <span class="pre">executed!</span></code>
should appear below the form. If an error occurred, you will see the message
<code class="docutils literal notranslate"><span class="pre">Sorry,</span> <span class="pre">there</span> <span class="pre">was</span> <span class="pre">a</span> <span class="pre">syntax</span> <span class="pre">error</span> <span class="pre">in</span> <span class="pre">your</span> <span class="pre">query.</span></code></p>
<p>After a successful <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>, view the <code class="docutils literal notranslate"><span class="pre">movies</span></code> table in Visual Studio
Code to confirm the new entry.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> the <code class="docutils literal notranslate"><span class="pre">movies</span></code> table to make yourself the director of one of the
existing films. Once you see <code class="docutils literal notranslate"><span class="pre">Query</span> <span class="pre">successfully</span> <span class="pre">executed</span></code>, view the table
in VS Code to confirm the change.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DELETE</span></code> a row from the <code class="docutils literal notranslate"><span class="pre">directors</span></code> table based on its <code class="docutils literal notranslate"><span class="pre">director_id</span></code>
value. Follow this with a <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> query to confirm the change.</p>
</li>
</ol>
<p>Continue testing your application until you are comfortable with how it works.</p>
</div>
</div>
<div class="section" id="display-column-names">
<h2><span class="section-number">24.11.3. </span>Display Column Names<a class="headerlink" href="#display-column-names" title="Permalink to this headline">¶</a></h2>
<p>Use the <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> form to run a few successful queries. Notice how the column
names do NOT appear in the output.</p>
<div class="figure align-default" id="id2">
<img alt="The results from a SELECT query displayed in a table. No column headings appear." src="../../_images/no-col-headings.png" />
<p class="caption"><span class="caption-text">It would be nice if the output displayed the column names!</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>To make the results more clear, it would be helpful to add the column names to
the output. <code class="docutils literal notranslate"><span class="pre">base.html</span></code> already contains code to do this, but it’s missing
some data.</p>
<div class="admonition-example admonition">
<p class="first admonition-title"><i class="fas fa-binoculars" aria-hidden="true"></i>Example</p>
<p>Take a look near the middle of <code class="docutils literal notranslate"><span class="pre">base.html</span></code>. The Jinja3 loop</p>
<p><code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">for</span> <span class="pre">column</span> <span class="pre">in</span> <span class="pre">session['selected_columns']</span> <span class="pre">%}</span></code></p>
<p>creates a heading for each column name assigned to <code class="docutils literal notranslate"><span class="pre">selected_columns</span></code>.</p>
<div class="last highlight-html notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">table</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span> <span class="c">&lt;!-- &#39;tr&#39; indicates a table row. &#39;th&#39; is a heading cell. --&gt;</span>

      <span class="c">&lt;!-- The &#39;selected_columns&#39; key points to a list of column names. --&gt;</span>
      {% for column in session[&#39;selected_columns&#39;] %}
         <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;centered&quot;</span><span class="p">&gt;</span>{{column.strip()}}<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
      {% endfor %}
   <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<p>To display the column names, you need to assign a list to the
<code class="docutils literal notranslate"><span class="pre">selected_columns</span></code> key in the session.</p>
<ol class="arabic">
<li><p class="first">Open <code class="docutils literal notranslate"><span class="pre">main.py</span></code> and find the <code class="docutils literal notranslate"><span class="pre">select_query()</span></code> function.</p>
</li>
<li><p class="first">Add a conditional just before calling <code class="docutils literal notranslate"><span class="pre">execute_query()</span></code>:</p>
<div class="highlight-Python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">select_query</span><span class="p">():</span>
   <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
      <span class="n">table</span> <span class="o">=</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span>
      <span class="n">columns</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;columns&#39;</span><span class="p">]</span>
      <span class="n">condition</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span>
      <span class="n">sql_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">columns</span><span class="si">}</span><span class="s2"> FROM </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
      <span class="k">if</span> <span class="n">condition</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
         <span class="n">sql_query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; WHERE </span><span class="si">{</span><span class="n">condition</span><span class="si">}</span><span class="s2">&quot;</span>

      <span class="c1"># Here&#39;s the 4 lines of new code!</span>
      <span class="k">if</span> <span class="n">columns</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span>
         <span class="n">session</span><span class="p">[</span><span class="s1">&#39;selected_columns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;columns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">session</span><span class="p">[</span><span class="s1">&#39;selected_columns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

      <span class="n">results</span> <span class="o">=</span> <span class="n">execute_query</span><span class="p">(</span><span class="n">sql_query</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</li>
</ol>
<p>Line 58 requests the string of column names from the SELECT form and assigns it
to the <code class="docutils literal notranslate"><span class="pre">columns</span></code> variable.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">columns</span> <span class="pre">==</span> <span class="pre">'*'</span></code> returns <code class="docutils literal notranslate"><span class="pre">True</span></code>, then line 66 runs. The
<code class="docutils literal notranslate"><span class="pre">selected_columns</span></code> key is assigned the full list of column names. If
<code class="docutils literal notranslate"><span class="pre">False</span></code>, then the string assigned to <code class="docutils literal notranslate"><span class="pre">columns</span></code> is split into a list. This
list is assigned to the session key.</p>
<p>Make the updates, then submit the SELECT form a few more times to test the new
feature.</p>
</div>
<div class="section" id="gloat">
<h2><span class="section-number">24.11.4. </span>Gloat<a class="headerlink" href="#gloat" title="Permalink to this headline">¶</a></h2>
<p>Whew! This was a long project, so take a moment to show off your work.</p>
</div>
<div class="section" id="bonus">
<h2><span class="section-number">24.11.5. </span>Bonus<a class="headerlink" href="#bonus" title="Permalink to this headline">¶</a></h2>
<p>Your SQL application now works, but there are ways to fine tune the project
to make it your own!</p>
<p>Feel free to update your program by doing any or all of the following:</p>
<ol class="arabic simple">
<li>Add CSS styling to make the forms look nicer.</li>
<li>Make the data collected from the forms entries case-insensitive.</li>
<li>To confirm changes made to a table, automatically run a <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> query
after <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code>, <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>, or <code class="docutils literal notranslate"><span class="pre">DELETE</span></code>.</li>
<li>Add more specific error messages based on what’s wrong with a SQL query.</li>
</ol>
</div>
</div>



    
    <nav aria-label="Next and Previous Pages">
      <ul class="pager">
        
        <li class="previous"><a href="project.html"><span aria-hidden="true">&larr;</span> <span class="section-number">24.10. </span>Project: Movie SQLs</a></li>
        
        
        <li class="next"><a href="../databases-part2/index.html"><span class="section-number">25. </span>Build a Minesweeper Game <span aria-hidden="true">&rarr;</span></a></li>
        
      </ul>
    </nav>
    
    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/chapters/databases/project-part2.rst.txt"
     rel="nofollow">Page Source</a>
</div>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>